name: Deployment Notification

on:
  push:
    branches:
      - main
      - dev

jobs:
  notify-replit:
    name: Notify Replit AI for Deployment
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Get commit info
        id: commit
        run: |
          echo "message=$(git log -1 --pretty=%s)" >> $GITHUB_OUTPUT
          echo "author=$(git log -1 --pretty=%an)" >> $GITHUB_OUTPUT
          echo "sha=$(git log -1 --pretty=%H)" >> $GITHUB_OUTPUT

      - name: Notify deployment needed
        run: |
          echo "ðŸš€ Deployment Notification"
          echo "Branch: ${{ github.ref_name }}"
          echo "Commit: ${{ steps.commit.outputs.sha }}"
          echo "Author: ${{ steps.commit.outputs.author }}"
          echo "Message: ${{ steps.commit.outputs.message }}"
          echo ""
          echo "ðŸ“‹ Action Required:"
          if [ "${{ github.ref_name }}" == "main" ]; then
            echo "âœ… Deploy to PRODUCTION (Replit AI)"
          else
            echo "ðŸ§ª Deploy to TESTING/STAGING (Replit AI)"
          fi
          echo ""
          echo "Replit will auto-deploy, or manually trigger in Replit console."

      # Optional: Send to Slack/Discord
      # - name: Send Slack notification
      #   uses: slackapi/slack-github-action@v1
      #   with:
      #     payload: |
      #       {
      #         "text": "New deployment needed on ${{ github.ref_name }}"
      #       }
      #   env:
      #     SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}

